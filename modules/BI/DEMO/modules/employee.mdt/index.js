(()=>{"use strict";var e={60:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.movePositionForm=function(e,t){const i=s.EMHelper.schema.tables.PositionHistory,l=o.Schema.getObject(i.code),r=l.getField(i.fields.idPosition),a=l.getField(i.fields.idPositionParent),n=l.getField(i.fields.flagTotalPeriod),d=l.getField(i.fields.dateBegin),c=o.FormService.createCustom({code:"em.PositionMove_virtual",title:o.Utils.getText("Move position"),fields:[{code:r.getCode(),title:r.getTitle(),type:r.getType(),refTableCode:s.EMHelper.schema.tables.Position.code,nullable:!1},{code:a.getCode(),title:a.getTitle(),type:a.getType(),refTableCode:s.EMHelper.schema.tables.Position.code,nullable:!0},{code:n.getCode(),title:n.getTitle(),type:n.getType(),nullable:!0},{code:d.getCode(),title:d.getTitle(),type:d.getType(),nullable:!1}],defaultValues:{[i.fields.idPosition]:e,[i.fields.idPositionParent]:t,[i.fields.dateBegin]:new Date,[i.fields.flagTotalPeriod]:!1},primaryButton:Object.assign({},s.EMHelper.buttons.movePosition),onSave:e=>(delete e.$table,o.Api.executeStoredProcedure(s.EMHelper.schema.sp.PositionMove,e))});return c.setFieldOptions({[i.fields.flagTotalPeriod]:{visible$:s.EMFormExpressions.isHistorical()},[i.fields.dateBegin]:{visible$:s.EMFormExpressions.dateVisibleMoveForms()}}),c.getFormCtrl()};const o=i(305),s=i(356)},305:function(e,t,i){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerModule=t.legacy=t.modules=t.App=t.Schema=t.UiComponents=t.ModuleRegistry=t.RecordManager=t.CommandManager=t.Page=t.Auth=t.Filter=t.m=t.Api=t.Ui=t.Utils=t.mUtils=t.FieldControl=t.ControlManager=t.Form=t.FormService=t.List=t.ListService=t.SecurityManager=t.Navigation=t.MDT=void 0;var s=o(i(523));t.MDT=window.MDT,t.Navigation=t.MDT.Navigation,t.SecurityManager=t.MDT.SecurityManager,t.ListService=t.MDT.ListService,t.List=t.MDT.List,t.FormService=t.MDT.FormService,t.Form=t.MDT.Form,t.ControlManager=t.MDT.ControlManager,t.FieldControl=t.MDT.FieldControl,t.mUtils=t.MDT.mUtils,t.Utils=t.MDT.Utils,t.Ui=t.MDT.Ui,t.Api=t.MDT.Api,t.m=t.MDT.m,t.Filter=t.MDT.Filter,t.Auth=t.MDT.Auth,t.Page=t.MDT.Page,t.CommandManager=t.MDT.CommandManager,t.RecordManager=t.MDT.RecordManager,t.ModuleRegistry=t.MDT.ModuleRegistry,t.UiComponents=t.MDT.UiComponents,t.Schema=t.MDT.Schema,t.App=t.MDT.App,t.modules=t.MDT.modules,t.legacy=t.MDT.legacy,t.registerModule=function(e,i){t.MDT.registerModule(e,{version:s.default.version,name:null==i?void 0:i.name})}},341:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergePositionForm=function(e){const t=o.EMHelper.schema.tables.PositionHistory,i=s.Schema.getObject(o.EMHelper.schema.tables.Position.code),l="ID_MainPosition",r=s.Schema.getObject(t.code),a=r.getField(t.fields.flagTotalPeriod),n=r.getField(t.fields.dateBegin),d=s.FormService.createCustom({code:"em.PositionMerge_virtual",title:s.Utils.getText("Merge positions"),fields:[{code:a.getCode(),title:a.getTitle(),type:a.getType(),nullable:!1},{code:n.getCode(),title:n.getTitle(),type:n.getType(),nullable:!1},{code:l,refTable:i,title:s.Utils.getText("Main record")}],defaultValues:{[t.fields.flagTotalPeriod]:!1,[t.fields.dateBegin]:new Date,[l]:null},primaryButton:Object.assign(Object.assign({},o.EMHelper.buttons.mergePositions),{execute:()=>{}}),onSave:e=>(delete e.$table,o.EMHelper.positionMerge(e,this.form.value(l),this.ids.filter(e=>e!=this.form.value(l)).join(","))),viewSettings:{hideSubTitle:!0,hideTitle:!0}});return d.setFieldOptions({[l]:{control:"gridpicker",listOptions:{disableRowCache:!0},filter:s.Filter.in("ID",e)},[t.fields.flagTotalPeriod]:{visible$:o.EMFormExpressions.isHistorical()},[t.fields.dateBegin]:{visible$:o.EMFormExpressions.dateVisibleMoveForms()}}),d.getFormCtrl()};const o=i(356),s=i(305)},356:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EMFormExpressions=t.EMHelper=t.EMSchema=void 0;const o=i(305),s=i(543),l=i(706),r=i(641),a=i(341),n=i(60);t.EMSchema={tables:{Position:{code:"em.Position",fields:{idPositionParent:"ID_PositionParent_Temp",dateOpen:"DateOpen",dateTermination:"DateTermination",flagTotalPeriod:"FlagTotalPeriod_Temp",employeeHistory:"EmployeeHistory"}},PositionHistory:{code:"em.Position_PositionHistory",fields:{idPosition:"ID_Position",idPositionParent:"ID_PositionParent",dateBegin:"DateBegin",dateEnd:"DateEnd",flagTotalPeriod:"FlagTotalPeriod"}},Employee:{code:"em.Employee",fields:{idPosition:"ID_Position_Temp",flagTotalPeriod:"FlagTotalPeriod_Temp",dateHire:"DateHire",employeePositionHistory:"EmployeeHistory",pathToPositionId:"EmployeeHistory/ID_Position",firstName:"FirstName",middleName:"MiddleName",lastName:"LastName",name:"Name"}},EmployeeHistory:{code:"em.Position_EmployeeHistory",fields:{idEmployee:"ID_Employee",idPosition:"ID_Position",flagTotalPeriod:"FlagTotalPeriod",dateBegin:"DateBegin"}}},sp:{PositionCreate:"em.usp_PositionCreate",PositionClose:"em.usp_PositionClose",PositionMerge:"em.usp_PositionMerge",PositionMove:"em.usp_PositionMove",EmployeeCreate:"em.usp_EmployeeCreate",EmployeeClose:"em.usp_EmployeeClose",EmployeeMove:"em.usp_EmployeeMove"},settings:{historyBindings:"ent.em.historyBindings"}};class d{static setSettings(e){this.settings=e}static isHistorical(){let e=this.settings[this.schema.settings.historyBindings];return!["0","false",null,void 0].includes(e)}static postionClose(e){return o.Api.executeStoredProcedure(this.schema.sp.PositionClose,e)}static positionMove(e){return o.Api.executeStoredProcedure(this.schema.sp.PositionMove,e)}static positionMerge(e,t,i){return o.Api.executeStoredProcedure(this.schema.sp.PositionMerge,e)}static employeeCreate(e){return o.Api.executeStoredProcedure(this.schema.sp.EmployeeCreate,e)}static employeeMove(e){return o.Api.executeStoredProcedure(this.schema.sp.EmployeeMove,e)}static employeeClose(e){return o.Api.executeStoredProcedure(this.schema.sp.EmployeeClose,e)}static showEmployeeFireForm(e,t){return o.Ui.showModal((0,s.employeeFireForm)(e),{onClose:t})}static showEmployeeMoveForm(e,t,i){return o.Ui.showModal((0,l.employeeMoveForm)(e,t),{onClose:i})}static showPositionCloseForm(e,t,i){return o.Ui.showModal((0,r.closePositionForm)(e,t),{onClose:i})}static showPositionsMergeForm(e,t){return o.Ui.showModal((0,a.mergePositionForm)(e),{onClose:t})}static showPositionMoveForm(e){const{id:t,parentId:i,onClose:s}=e;return o.Ui.showModal((0,n.movePositionForm)(t,i),{onClose:s})}}t.EMHelper=d,d.schema=t.EMSchema,d.settings={},d.buttons={openPosition:{title:"Open"},movePosition:{title:"Move",icon:"share",visible:()=>o.SecurityManager.hasPermission(o.Schema.getObject(d.schema.tables.Position.code),o.SecurityManager.PermissionLevel.Write)},mergePositions:{title:"Merge",icon:"code-branch",visible:()=>!1},closePosition:{title:"Close",icon:"minus",visible:()=>o.SecurityManager.hasPermission(o.Schema.getObject(d.schema.tables.Position.code),o.SecurityManager.PermissionLevel.Write)},hireEmployee:{title:"Hire"},moveEmployee:{title:"Move",icon:"share",visible:()=>o.SecurityManager.hasPermission(o.Schema.getObject(d.schema.tables.Employee.code),o.SecurityManager.PermissionLevel.Write)},fireEmployee:{title:"Fire",icon:"user-times",visible:()=>o.SecurityManager.hasPermission(o.Schema.getObject(d.schema.tables.Employee.code),o.SecurityManager.PermissionLevel.Write)}},t.EMFormExpressions={isHistorical:()=>({$:"literal",exp:`${d.isHistorical()}`}),isNew:()=>({$:"eq",arg1:{$:"field",path:"ID"},arg2:{$:"literal",exp:"null"}}),periodAvailable:()=>({$:"and",ops:[t.EMFormExpressions.isNew(),t.EMFormExpressions.isHistorical()]}),dateVisible:e=>({$:"and",ops:[t.EMFormExpressions.isHistorical(),{$:"not",op:{$:"field",path:e||"FlagTotalPeriod"}}]}),dateRequired:e=>({$:"and",ops:[t.EMFormExpressions.periodAvailable(),{$:"not",op:{$:"field",path:e||"FlagTotalPeriod"}}]}),dateVisibleMoveForms:e=>({$:"and",ops:[t.EMFormExpressions.isHistorical(),{$:"not",op:{$:"field",path:e||"FlagTotalPeriod"}}]})}},397:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EmployeeListCtrl=void 0;const o=i(356),s=i(305);t.EmployeeListCtrl=class{constructor(e){var t,i;let l;try{l=e.controlTemplate?JSON.parse(e.controlTemplate):{}}catch(e){console.log("Warning: wrong navigation node config!",e)}var r=e=>{var t,i,o;e&&(null===(o=null===(i=null===(t=this.list.getListCtrl().exts)||void 0===t?void 0:t.select)||void 0===i?void 0:i.rows)||void 0===o||o.call(i),this.list.refresh())};const a={select:{multi:!0},fixedHeader:!0,dragDrop:{reorder:!1,droppable:{drop:(e,t)=>{let i=s.RecordManager.valueByPath(t,o.EMHelper.schema.tables.Employee.fields.pathToPositionId,o.EMHelper.schema.tables.Employee.code);o.EMHelper.showEmployeeMoveForm(e.$id,i&&i[0]?i[0]:null,r)},canDrop:(e,t)=>e&&t&&e.$id!=t.$id},canDrop:(e,t)=>e&&t&&e.$id!=t.$id},form:{addButton:Object.assign({},o.EMHelper.buttons.hireEmployee),add:!0,delete:!0},toolbar:{buttons:[Object.assign(Object.assign({},o.EMHelper.buttons.moveEmployee),{command:()=>{var e=this.list.getSelectedRows();let t=e[1]?s.RecordManager.valueByPath(e[1],o.EMHelper.schema.tables.Employee.fields.pathToPositionId,o.EMHelper.schema.tables.Employee.code):null;o.EMHelper.showEmployeeMoveForm(e[0]&&e[0].$id,t,r)}}),Object.assign(Object.assign({},o.EMHelper.buttons.fireEmployee),{enabled:()=>1===this.list.getSelectedRows().length,command:()=>{o.EMHelper.showEmployeeFireForm(this.list.getSelectedRows()[0].$id,r)}})]},columnMenu:!0,export:null===(i=null===(t=null==l?void 0:l.extConfig)||void 0===t?void 0:t.export)||void 0===i||i,virtualScroll:!0,merge:!1,listView:{},namedFilter:{},import:!0,tag:{},status:{},labelStyle:{},dataExt:!0,inline:{},gallery:{},historyType:!!o.EMHelper.isHistorical()&&{},hierarchy:{legacy:!0,parentField:"EmployeeHistory/ID_Position/PositionHistory/ID_PositionParent",primaryField:"EmployeeHistory/ID_Position/ID"},cellControl:{},dup:{}},n=s.legacy.utils.combine(s.legacy.NavigationControlManager.OpenFormExtender(),a);this.list=s.ListService.create(o.EMHelper.schema.tables.Employee.code,{filter:{op:"eq",p1:"ID_mapping_Datasource",p2:"1"},root:!0,fkLinks:!0,events:[e=>{const t=o.EMHelper.schema.tables.Employee.fields.pathToPositionId;e.select.indexOf(t)<0&&e.select.push(t)}]},n),this.content=this.list.getListCtrl()}}},523:e=>{e.exports=JSON.parse('{"name":"mdt-client","version":"31.0.13","description":"","main":"dist/index.js","types":"dist/index.d.ts","files":["/dist","/types"],"scripts":{"build":"tsc","types-update":"tsc --project tsconfig.facade-types.json","update":"tsc --project tsconfig.facade-types.json && tsc","pub-patch":"npm version patch && npm publish","pub-minor":"npm version minor && npm publish"},"repository":{"type":"git","url":"git@gitlab.ics-it.ru:mdtc/mdt-facade.git"},"author":"","license":"ISC","devDependencies":{"typescript":"^4.8.4"},"dependencies":{"@types/mithril":"^0.0.27"}}')},543:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.employeeFireForm=function(e){const t=o.EMHelper.schema.tables.EmployeeHistory,i=s.Schema.getObject(t.code).getField(t.fields.idEmployee),l="DateTermination";return s.FormService.createCustom({code:"em.EmployeeFire_virtual",title:s.Utils.getText("Fire employee"),fields:[{title:i.getTitle(),code:i.getCode(),type:i.getType(),refTableCode:o.EMHelper.schema.tables.Employee.code,nullable:!1},{code:"DateTermination",title:s.Utils.getText("Termination Date"),type:"date",nullable:!1}],onSave:e=>(delete e.$table,s.Api.executeStoredProcedure(o.EMHelper.schema.sp.EmployeeClose,e)),defaultValues:{[i.getCode()]:e,[l]:o.EMHelper.isHistorical()?new Date:null},primaryButton:Object.assign({},o.EMHelper.buttons.fireEmployee)}).getFormCtrl()};const o=i(356),s=i(305)},641:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.closePositionForm=function(e,t){const i=o.EMHelper.schema.tables.PositionHistory,l=o.EMHelper.schema.tables.Position,r=s.Schema.getObject(i.code).getField(i.fields.idPosition),a=s.Schema.getObject(l.code).getField(l.fields.dateTermination);return s.FormService.createCustom({title:s.Utils.getText("Close position"),code:"em.PostionClose_virtual",fields:[{code:r.getCode(),title:r.getTitle(),type:r.getType(),refTableCode:o.EMHelper.schema.tables.Position.code,nullable:!1},{code:a.getCode(),type:a.getType(),title:s.Utils.getText("Position close date"),readonly:!1,nullable:!0}],defaultValues:{[i.fields.idPosition]:e,[l.fields.dateTermination]:t?null:new Date},onSave:e=>(delete e.$table,s.Api.executeStoredProcedure(o.EMHelper.schema.sp.PositionClose,e)),primaryButton:Object.assign({},o.EMHelper.buttons.closePosition)}).getFormCtrl()};const o=i(356),s=i(305)},680:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EmployeeFormExtender=void 0;const o=i(356);class s{parseToString(e){const t=[];return e.LastName&&t.push(e.LastName),e.FirstName&&t.push(e.FirstName),e.MiddleName&&t.push(e.MiddleName),t.join(" ")}parseFromString(e){if(e){var t=e.split(" ");switch(t.length){case 1:return{FirstName:t[0]};case 2:return{FirstName:t[1],LastName:t[0]};default:return{FirstName:t[1],LastName:t[0],MiddleName:t.slice(2).join(" ")}}}}}class l{static Extend(e){const t=new s;e.onUpdated((i,o)=>{const s=i.getCode();if(s!=this.fullNameField)this.namePartFields.includes(s)&&(l=this.getPartFields(e),this.updateFullNameField(e,t.parseToString(l)));else{var l=t.parseFromString(o);this.updatePartFields(e,l)}})}static getPartFields(e){return{FirstName:e.value(o.EMSchema.tables.Employee.fields.firstName),LastName:e.value(o.EMSchema.tables.Employee.fields.lastName),MiddleName:e.value(o.EMSchema.tables.Employee.fields.middleName)}}static updatePartFields(e,t){var i,s,l;e.value(o.EMSchema.tables.Employee.fields.firstName,null!==(i=null==t?void 0:t.FirstName)&&void 0!==i?i:"",null,!1),e.value(o.EMSchema.tables.Employee.fields.lastName,null!==(s=null==t?void 0:t.LastName)&&void 0!==s?s:"",null,!1),e.value(o.EMSchema.tables.Employee.fields.middleName,null!==(l=null==t?void 0:t.MiddleName)&&void 0!==l?l:"",null,!1)}static updateFullNameField(e,t){e.value(this.fullNameField,t,null,!1)}}t.EmployeeFormExtender=l,l.fullNameField=o.EMSchema.tables.Employee.fields.name,l.namePartFields=[o.EMSchema.tables.Employee.fields.firstName,o.EMSchema.tables.Employee.fields.lastName,o.EMSchema.tables.Employee.fields.middleName]},706:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.employeeMoveForm=function(e,t){const i=s.EMHelper.schema.tables.EmployeeHistory,l="ID_PositionTo",r=o.Schema.getObject(i.code),a=r.getField(i.fields.idPosition),n=r.getField(i.fields.idEmployee),d=r.getField(i.fields.flagTotalPeriod),c=r.getField(i.fields.dateBegin),m=o.FormService.createCustom({code:"em.EmployeeMove_virtual",title:o.Utils.getText("Move employee"),fields:[{code:l,title:a.getTitle(),type:a.getType(),refTableCode:s.EMHelper.schema.tables.Position.code,nullable:!1},{title:n.getTitle(),code:n.getCode(),type:n.getType(),refTableCode:s.EMHelper.schema.tables.Employee.code,nullable:!1},{title:d.getTitle(),code:d.getCode(),type:d.getType()},{title:c.getTitle(),code:c.getCode(),type:c.getType(),nullable:!1}],defaultValues:{[l]:t,[i.fields.idEmployee]:e,[i.fields.dateBegin]:new Date},primaryButton:Object.assign({},s.EMHelper.buttons.moveEmployee),onSave:e=>(delete e.$table,o.Api.executeStoredProcedure(s.EMHelper.schema.sp.EmployeeMove,e))});return m.setFieldOptions({[i.fields.flagTotalPeriod]:{visible$:s.EMFormExpressions.isHistorical()},[i.fields.dateBegin]:{visible$:s.EMFormExpressions.dateVisibleMoveForms()}}),m.getFormCtrl()};const o=i(305),s=i(356)},983:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PositionListCtrl=void 0;const o=i(305),s=i(356);t.PositionListCtrl=class{constructor(e){var t,i;let l;try{l=e.controlTemplate?JSON.parse(e.controlTemplate):{}}catch(e){console.log("Warning: wrong navigation node config!",e)}const r=e=>{var t,i,o;e&&(null===(o=null===(i=null===(t=this.list.getListCtrl().exts)||void 0===t?void 0:t.select)||void 0===i?void 0:i.rows)||void 0===o||o.call(i),this.list.refresh())},a=s.EMHelper.schema.tables.Position.fields.dateTermination,n={select:{multi:!0},dragDrop:{draggable:{getSrcData:e=>e},droppable:{drop:(e,t)=>s.EMHelper.showPositionMoveForm({id:e.$id,parentId:t.$id,onClose:r}),canDrop:(e,t)=>e&&t&&e.$id!=t.$id}},form:{addButton:Object.assign({},s.EMHelper.buttons.openPosition),add:!0,delete:!0},toolbar:{buttons:[Object.assign(Object.assign({},s.EMHelper.buttons.closePosition),{enabled:()=>1===this.list.getSelectedRows().length,command:()=>s.EMHelper.showPositionCloseForm(this.list.getSelectedRows()[0].$id,this.list.getSelectedRows()[0][a],r)}),Object.assign(Object.assign({},s.EMHelper.buttons.mergePositions),{enabled:()=>new Set(this.list.getSelectedRows().map(e=>e.$id)).size>=2,command:()=>s.EMHelper.showPositionsMergeForm(this.list.getSelectedRows().map(e=>e.$id),r)}),Object.assign(Object.assign({},s.EMHelper.buttons.movePosition),{command:()=>{var e=this.list.getSelectedRows();s.EMHelper.showPositionMoveForm({id:e[0]&&e[0].$id,parentId:e[1]&&e[1].$id,onClose:r})}})]},columnMenu:!0,export:null===(i=null===(t=null==l?void 0:l.extConfig)||void 0===t?void 0:t.export)||void 0===i||i,virtualScroll:!0,listView:{},namedFilter:{},merge:!1,dataExt:!0,inline:{},gallery:{},historyType:!!s.EMHelper.isHistorical()&&{},hierarchy:{legacy:!0,parentField:"PositionHistory/ID_PositionParent",primaryField:"ID"},cellControl:{}},d=o.legacy.utils.combine(o.legacy.NavigationControlManager.OpenFormExtender(),n);this.list=o.ListService.create(s.EMHelper.schema.tables.Position.code,{filter:{op:"eq",p1:"ID_mapping_Datasource",p2:"1"},root:!0,fkLinks:!0},d),this.content=this.list.getListCtrl()}}}},t={};function i(o){var s=t[o];if(void 0!==s)return s.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,i),l.exports}(()=>{const e=i(305),t=i(983),o=i(397),s=i(356),l=i(356),r=i(680);e.Navigation.registerPageCtrl(o.EmployeeListCtrl,"EmployeeListCtrl"),e.Navigation.registerPageCtrl(t.PositionListCtrl,"PositionListCtrl");const a="mdt.GlobalVar",n=e.Schema.getObject(a,!0);function d(e){const t={};e.getObject().getFields().filter(e=>e.isHistory()).forEach(i=>{t[i.getCode()]={visible:()=>!!e.getRecordId()}}),e.setFieldOptions(t)}function c(e){e.reinit(),e.notifyDataUpdated()}n&&e.SecurityManager.hasPermission(n,e.SecurityManager.PermissionLevel.Read)&&e.Api.fetch(a,{filter:e.Filter.startsWith("Code","ent.em.")}).then(e=>{let t={};e.records.forEach(e=>t[e.Code]=e.Value),s.EMHelper.setSettings(t)}),e.ListService.onCreate(e=>{e.getObject().getCode()!=s.EMHelper.schema.tables.Position.code&&e.getObject().getCode()!=s.EMHelper.schema.tables.Employee.code||e.setExtOptions({hierarchy:{legacy:!0}})}),e.FormService.onCreated(t=>{if(t.getObject().getCode()==s.EMHelper.schema.tables.Position.code){const i=s.EMHelper.schema.tables.Position.fields.dateTermination;t.addCommand(Object.assign(Object.assign({},s.EMHelper.buttons.closePosition),{title:"Close position",execute:()=>{s.EMHelper.showPositionCloseForm(t.getRecordId(),t.value(i),()=>c(t))},visible:()=>!!t.getRecordId()&&!t.value(i)&&!t.getObject().isReadonly()})),t.addCommand({icon:"redo",title:"Reopen position",execute:()=>e.Api.executeStoredProcedure(s.EMHelper.schema.sp.PositionClose,{[s.EMHelper.schema.tables.PositionHistory.fields.idPosition]:t.getRecordId()}).then(()=>c(t)),visible:()=>!!t.getRecordId()&&t.value(i)&&!t.getObject().isReadonly()}),t.addCommand(Object.assign(Object.assign({},s.EMHelper.buttons.movePosition),{execute:()=>{s.EMHelper.showPositionMoveForm({id:t.getRecordId()})},visible:()=>!!t.getRecordId()&&!t.getObject().isReadonly()}));const o=s.EMHelper.schema.tables.Position.fields;t.setFieldOptions({[o.flagTotalPeriod]:{visible$:s.EMFormExpressions.periodAvailable()},[o.dateOpen]:{visible$:s.EMFormExpressions.dateVisible(o.flagTotalPeriod),nullable$:{$:"not",op:s.EMFormExpressions.dateVisible(o.flagTotalPeriod)}},[o.idPositionParent]:{visible$:s.EMFormExpressions.isNew()}}),d(t)}else if(t.getObject().getCode()==s.EMHelper.schema.tables.Employee.code){t.getRecordId()&&(t.addCommand(Object.assign(Object.assign({},s.EMHelper.buttons.moveEmployee),{execute:()=>{s.EMHelper.showEmployeeMoveForm(t.getRecordId(),null,()=>c(t))},visible:()=>!!t.getRecordId()&&!t.getObject().isReadonly()})),t.addCommand(Object.assign(Object.assign({},s.EMHelper.buttons.fireEmployee),{execute:()=>{s.EMHelper.showEmployeeFireForm(t.getRecordId(),()=>c(t))},visible:()=>!!t.getRecordId()&&!t.getObject().isReadonly()})));const i=s.EMHelper.schema.tables.Employee.fields;t.setFieldOptions({ID_mdt_Principal:{filter:e.Filter.eq("ID_PrincipalType",e.SecurityManager.PrincipalTypes.User)},ID_EmployeeType:{filter:e.Filter.ne("FlagSystem",!0)},[i.flagTotalPeriod]:{visible$:s.EMFormExpressions.periodAvailable()},[i.dateHire]:{visible$:s.EMFormExpressions.dateVisible(i.flagTotalPeriod),nullable$:{$:"not",op:s.EMFormExpressions.dateRequired(i.flagTotalPeriod)}},[i.idPosition]:{visible$:s.EMFormExpressions.isNew(),nullable$:()=>!!t.getRecordId()}}),d(t)}}),e.FormService.onCreate(e=>{e.getObject().getCode()===l.EMSchema.tables.Employee.code&&r.EmployeeFormExtender.Extend(e)}),(0,e.registerModule)(()=>{},{name:"employee"})})()})();
//# sourceMappingURL=index.js.map