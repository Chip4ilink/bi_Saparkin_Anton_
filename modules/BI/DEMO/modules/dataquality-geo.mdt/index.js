(()=>{"use strict";var e={63:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseHouseDetails=void 0;const o=n(297);t.parseHouseDetails=function(e){var t;const n={};if(!e)return n;var i=e=>new RegExp("("+e.join("|")+")\\s(\\S*)"),r=e.match(i(["к"]));r&&(n.corps=r[1],n.corpsValue=r[2],e=null==e?void 0:e.replace(r[1]+" "+r[2],""));var a=e.match(i(o.GeoManager.getStrHouseStatuses().map(e=>e.toLowerCase())));a&&(n.str=a[1],n.strValue=a[2],e=null==e?void 0:e.replace(a[1]+" "+a[2],"")),n.house=e;for(let e in n)n[e]=null===(t=n[e])||void 0===t?void 0:t.trim();return n}},72:(e,t,n)=>{var o,i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function a(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},o=[],i=0;i<e.length;i++){var s=e[i],c=t.base?s[0]+t.base:s[0],l=n[c]||0,d="".concat(c," ").concat(l);n[c]=l+1;var u=a(d),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(r[u].references++,r[u].updater(p)):r.push({identifier:d,updater:g(p,t),references:1}),o.push(d)}return o}function c(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var r=n.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach(function(e){t.setAttribute(e,o[e])}),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,d=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function u(e,t,n,o){var i=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var r=document.createTextNode(i),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(r,a[t]):e.appendChild(r)}}function p(e,t,n){var o=n.css,i=n.media,r=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var h=null,A=0;function g(e,t){var n,o,i;if(t.singleton){var r=A++;n=h||(h=c(t)),o=u.bind(null,n,r,!1),i=u.bind(null,n,r,!0)}else n=c(t),o=p.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var i=a(n[o]);r[i].references--}for(var c=s(e,t),l=0;l<n.length;l++){var d=a(n[l]);0===r[d].references&&(r[d].updater(),r.splice(d,1))}n=c}}}},229:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(991),i=n.n(o),r=n(314),a=n.n(r)()(i());a.push([e.id,".data-quality-geo {\n  border-style: solid none;\n  border-width: 1px;\n  border-color: #e4e4e4;\n  margin: 10px auto;\n}\n.data-quality-geo .address {\n  padding: 10px 10px;\n  display: flex;\n  align-items: center;\n}\n.data-quality-geo .address .address-country {\n  margin-right: 18px;\n}\n.data-quality-geo .address .input-control {\n  padding-right: 25px;\n}\n.data-quality-geo .address .address-title {\n  font-size: 16px;\n  font-weight: 500;\n  margin-right: 10px;\n  text-wrap: nowrap;\n}\n.data-quality-geo .address .address-absolute-content {\n  position: absolute;\n  right: 75px;\n}\n.data-quality-geo .address-details {\n  padding: 10px;\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  gap: 5px;\n}\n.data-quality-geo .address-details .common-control-wrap:first-child .common-control-content .address-details-house > .common-control-wrap:first-child {\n  padding-left: 0px;\n}\n.data-quality-geo .address-details .common-control-wrap {\n  width: 100%;\n}\n.data-quality-geo .address-details .common-control-wrap .common-control-icon {\n  font-size: 13px;\n  width: 40px;\n  margin: 0;\n  text-align: center;\n  align-items: center;\n  padding-right: 10px;\n}\n.data-quality-geo .address-details .common-control-wrap .common-control-content * {\n  display: flex;\n  background: none;\n  border: 0;\n}\n.data-quality-geo .address-details .common-control-wrap .common-control-content > div > .common-control-wrap:first-child {\n  width: auto;\n  padding-left: 5px;\n  padding-right: 10px;\n}\n.data-quality-geo .address-details .common-control-wrap .address-details-house .common-control {\n  border: none;\n}\n.data-quality-geo .map {\n  padding-bottom: 10px;\n}\n.data-quality-geo .fc-action {\n  padding: 0 0 0 5px;\n}\n","",{version:3,sources:["webpack://./src/Controls/styles.less"],names:[],mappings:"AAAA;EACE,wBAAA;EACA,iBAAA;EACA,qBAAA;EACA,iBAAA;AACF;AALA;EAOI,kBAAA;EACA,aAAA;EACA,mBAAA;AACJ;AAVA;EAYM,kBAAA;AACN;AAbA;EAgBM,mBAAA;AAAN;AAhBA;EAoBM,eAAA;EACA,gBAAA;EACA,kBAAA;EACA,iBAAA;AADN;AAtBA;EA2BM,kBAAA;EACA,WAAA;AAFN;AA1BA;EAiCI,aAAA;EACA,mBAAA;EACA,aAAA;EACA,8BAAA;EACA,QAAA;AAJJ;AAjCA;EA2CY,iBAAA;AAPZ;AApCA;EAkDM,WAAA;AAXN;AAvCA;EAqDQ,eAAA;EACA,WAAA;EACA,SAAA;EACA,kBAAA;EACA,mBAAA;EACA,mBAAA;AAXR;AA/CA;EA8DQ,aAAA;EACA,gBAAA;EACA,SAAA;AAZR;AApDA;EAsEY,WAAA;EACA,iBAAA;EACA,mBAAA;AAfZ;AAzDA;EAgFU,YAAA;AApBV;AA5DA;EAuFI,oBAAA;AAxBJ;AA/DA;EA2FI,kBAAA;AAzBJ",sourcesContent:[".data-quality-geo {\n  border-style: solid none;\n  border-width: 1px;\n  border-color: #e4e4e4;\n  margin: 10px auto;\n\n  .address {\n    padding: 10px 10px;\n    display: flex;\n    align-items: center;\n\n    .address-country {\n      margin-right: 18px;\n    }\n\n    .input-control{\n      padding-right: 25px;\n    }\n\n    .address-title {\n      font-size: 16px;\n      font-weight: 500;\n      margin-right: 10px;\n      text-wrap: nowrap;\n    }\n\n    .address-absolute-content {\n      position: absolute;\n      right: 75px;\n    }\n  }\n\n  .address-details {\n    padding: 10px;\n    align-items: center;\n    display: flex;\n    justify-content: space-between;\n    gap: 5px;\n\n    .common-control-wrap:first-child {\n      .common-control-content {\n        .address-details-house {\n          > .common-control-wrap:first-child {\n            padding-left: 0px;\n          }  \n        }\n      }\n    }\n\n    .common-control-wrap {\n      width: 100%;\n\n      .common-control-icon {\n        font-size: 13px;\n        width: 40px;\n        margin: 0;\n        text-align: center;\n        align-items: center;\n        padding-right: 10px;\n      }\n\n      .common-control-content * {\n        display: flex;\n        background: none;\n        border: 0;\n      }\n\n      .common-control-content {\n        > div {\n          > .common-control-wrap:first-child {\n            width: auto;\n            padding-left: 5px;\n            padding-right: 10px;\n          }\n        }\n      }\n\n      .address-details-house\n      {\n        .common-control {\n          border: none;\n        }\n      }\n    }\n  }\n\n  .map {\n    padding-bottom: 10px;\n  }\n\n  .fc-action {\n    padding: 0 0 0 5px;\n  }\n}"],sourceRoot:""}]);const s=a},297:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.GeoManager=t.geo=void 0;const i=n(305);t.geo={schema:{tables:{country:{code:"geo.Country",fields:{id:"ID",name:"ShortName",alfa3Code:"Alfa3Code"}},geoObjRecord:{code:"geo.GeographyObjectRecord",fields:{id:"ID",geographyObjectSettings:"ID_GeographyObjectSettings",recordId:"ID_Record",address:"Address",geographyId:"ID_Geography",cityDistrictId:"ID_CityDistrict",statusId:"ID_Status",house:"House",latitude:"Latitude",longitude:"Longitude",fullAddress:"FullAddress",country:"Country",geospatialStatusId:"ID_GeospatialStatus",comment:"Comment",cityPath:"ID_Geography/ID_ParentLevel2/Name",geoHistory:"GeoHistory",countryId:"ID_Country",addressAccuracyId:"ID_AddressAccuracy"}}},defaultBaseField:"Address_DS"}},t.GeoManager=class{static getGeographyObjectRecord(e,n){return o(this,void 0,void 0,function*(){return i.Api.fetchRecord(t.geo.schema.tables.geoObjRecord.code,{filter:i.Filter.and(i.Filter.eq("ID_mdt_Object",e.getId()),i.Filter.eq("ID_Record",n)),top:1})})}static getStrHouseStatuses(){return["стр","секция","литер","соор"]}}},305:function(e,t,n){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerModule=t.legacy=t.App=t.Schema=t.UiComponents=t.ModuleRegistry=t.RecordManager=t.CommandManager=t.Page=t.Auth=t.Filter=t.m=t.Api=t.Ui=t.Utils=t.mUtils=t.FieldControl=t.ControlManager=t.Form=t.FormService=t.List=t.ListService=t.SecurityManager=t.Navigation=t.MDT=void 0;var i=o(n(523));t.MDT=window.MDT,t.Navigation=t.MDT.Navigation,t.SecurityManager=t.MDT.SecurityManager,t.ListService=t.MDT.ListService,t.List=t.MDT.List,t.FormService=t.MDT.FormService,t.Form=t.MDT.Form,t.ControlManager=t.MDT.ControlManager,t.FieldControl=t.MDT.FieldControl,t.mUtils=t.MDT.mUtils,t.Utils=t.MDT.Utils,t.Ui=t.MDT.Ui,t.Api=t.MDT.Api,t.m=t.MDT.m,t.Filter=t.MDT.Filter,t.Auth=t.MDT.Auth,t.Page=t.MDT.Page,t.CommandManager=t.MDT.CommandManager,t.RecordManager=t.MDT.RecordManager,t.ModuleRegistry=t.MDT.ModuleRegistry,t.UiComponents=t.MDT.UiComponents,t.Schema=t.MDT.Schema,t.App=t.MDT.App,t.legacy=t.MDT.legacy,t.registerModule=function(e,n){t.MDT.registerModule(e,{version:i.default.version,name:null==n?void 0:n.name})}},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=e(t);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n}).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(o)for(var r=0;r<this.length;r++){var a=this[r][0];null!=a&&(i[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);o&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},458:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getGeoMatchingStatus=t.MatchingStatus=void 0,function(e){e[e.NOT_MATCH=0]="NOT_MATCH",e[e.PARTIAL=1]="PARTIAL",e[e.FULL=2]="FULL"}(n=t.MatchingStatus||(t.MatchingStatus={})),t.getGeoMatchingStatus=function(e){let t=n.NOT_MATCH;return e?(e.ID_Geography&&e.House&&e.Latitude&&e.Longitude?t=n.FULL:e.ID_Geography&&(t=n.PARTIAL),t):t}},523:e=>{e.exports=JSON.parse('{"name":"mdt-client","version":"31.0.12","description":"","main":"dist/index.js","types":"dist/index.d.ts","files":["/dist","/types"],"scripts":{"build":"tsc","types-update":"tsc --project tsconfig.facade-types.json","update":"tsc --project tsconfig.facade-types.json && tsc","pub-patch":"npm version patch && npm publish","pub-minor":"npm version minor && npm publish"},"repository":{"type":"git","url":"git@gitlab.ics-it.ru:mdtc/mdt-facade.git"},"author":"","license":"ISC","devDependencies":{"typescript":"^4.8.4"},"dependencies":{"@types/mithril":"^0.0.27"}}')},678:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKeyStorage=void 0;const o=n(725);t.getKeyStorage=function(e,t,n){var i;const r=null===(i=o._.storage(e))||void 0===i?void 0:i.key;return n!==r&&o._.storage(e,null,!0),{get:()=>{const i=o._.storage(e);return i?n?i.value:i:null!=t?t:null},set:t=>{const i=n?{value:t,key:n}:t;o._.storage(e,i)},clear(){}}}},725:(e,t)=>{function n(){return Math.random().toString(32).slice(-6)}function o(e,...t){return"function"==typeof e?e(...t):e}Object.defineProperty(t,"__esModule",{value:!0}),t.getValued=t.getShortUID=t._=void 0,t._={},t._.storage=(e,t,n=!1)=>{const o="price-list:"+e;if(n&&localStorage.removeItem(o),void 0!==t)try{return localStorage[o]=JSON.stringify(t)}catch(e){console.error(e)}else try{return JSON.parse(localStorage[o]||localStorage[e]||null)}catch(t){return localStorage[e]}},t._.$resources={},t._.loadScript=(e,n)=>t._.loadResource(e,{attr:"src",tag:"script",type:"text/javascript"},n),t._.loadResource=(e,o,i={})=>{if(t._.$resources[e])return t._.$resources[e];const r=m.deferred();t._.$resources[e]=r.promise;const a=document.getElementsByTagName(o.tag);if(Array.from(a).find(t=>t[o.attr].indexOf(e)>=0))return void r.resolve();let s=!1;const c=document.createElement(o.tag);var l;c.type=o.type,i.disableCache&&(e=(l=e)+`${-1===l.indexOf("?")?"?":"&"}${n()}`),c[o.attr]=e,Object.keys(o.extra||{}).forEach(e=>c[e]=o[e]),c.onload=c.onreadystatechange=function(){s||this.readyState&&"complete"!=this.readyState||(s=!0,r.resolve())},i.onerror&&(c.onerror=i.onerror);const d=document.getElementsByTagName(o.tag)[0];return d.parentNode.insertBefore(c,d),r.promise},t.getShortUID=n,t._.v=o,t.getValued=o,t._.text=e=>"TRANSLATED",t._.deepEqual=(e,t,n)=>{const i=Object.assign({keyFilter:e=>!0,execFunc:(e,t)=>"filter"==e.name.toLowerCase()},n),r=[],a=[];return function e(t,n){if(null==t||null==n)return t===n;if(t.constructor!==n.constructor)return!1;if(t instanceof Function)return o(i.execFunc,t,n)?e(t(),n()):t===n;if(t instanceof RegExp)return t===n;if(t===n||t.valueOf()===n.valueOf())return!0;if(Array.isArray(t)&&t.length!==n.length)return!1;if(t instanceof Date)return!1;if(!(t instanceof Object))return!1;if(!(n instanceof Object))return!1;if(r.indexOf(t)>=0&&a.indexOf(n)>=0)return!0;r.push(t),a.push(n);const s=Object.keys(t).filter(i.keyFilter);return Object.keys(n).filter(i.keyFilter).every(e=>-1!==s.indexOf(e))&&s.every(o=>e(t[o],n[o]))}(e,t)}},769:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.SimplifiedGeoCtrl=void 0;const i=n(305),r=n(803),a=n(297),s=n(63),c=n(458);class l{constructor(e,t){var n,o;this.form=e,this.options=t,this.showDetails=!1,this.$view=()=>{var e;return m(".data-quality-geo",[m(".address",[m(".address-title",this.titleElement),m(".address-country",this.countryElement),this.addressElement,m(".address-absolute-content",[this.statusElement]),this.showDetailsElement,this.showMapButton]),this.showDetails?this.detailsElement:null,this.Map&&this.Map.options.visible?m(".map",null===(e=this.Map)||void 0===e?void 0:e.getViewElement()):""])},this.titleElement=i.Utils.getText("dqgeo:Address"),this.initCountry(),this.initAddress(),this.initShowDetails(),this.initShowMapButton(),this.initDetails();const r=null===(o=null===(n=e.getObject().object.fields.find(e=>e.primary))||void 0===n?void 0:n.refTable)||void 0===o?void 0:o.code,c=r?i.Schema.getObject(r):e.getObject();a.GeoManager.getGeographyObjectRecord(c,e.getRecordId()).then(e=>{e&&(this.geographyObjectRecord=e,this.houseDetails=(0,s.parseHouseDetails)(e.House),this.initAddress(),this.initStatus(),this.initCountry(),this.initMap(),this.initDetails())})}initCountry(){var e,t;const n=(e,t)=>{t||e.addEventListener("click",()=>{var e;if(!(null===(e=this.geographyObjectRecord)||void 0===e?void 0:e.ID_Country))return;const t=i.FormService.create(a.geo.schema.tables.country.code,this.geographyObjectRecord.ID_Country,{readonly:!0});i.Ui.showModal(t)})};this.countryElement=i.UiComponents.commonControl({readonly:!0,content:m("a.selector-link",{config:(e,t)=>{n(e,t)}},null!==(t=null===(e=this.geographyObjectRecord)||void 0===e?void 0:e.ID_Country$.ShortName)&&void 0!==t?t:l.empty()),contentAttrs:{className:"address-country"}})}initAddress(){var e,t;this.addressElement=i.UiComponents.input({readonly:!0,value:null!==(t=null===(e=this.geographyObjectRecord)||void 0===e?void 0:e.FullAddress)&&void 0!==t?t:l.empty()})}initStatus(){let e=(0,c.getGeoMatchingStatus)(this.geographyObjectRecord);const t=(e,t,n)=>i.UiComponents.icon(e,{tooltip:i.Utils.getText(n),className:"icon-brand-"+t});e==c.MatchingStatus.FULL&&(this.statusElement=t("check","success","dqgeo:AddressComplete")),e==c.MatchingStatus.PARTIAL&&(this.statusElement=t("check","warning","dqgeo:AddressPartiallyFilled")),e==c.MatchingStatus.NOT_MATCH&&(this.statusElement=t("exclamation-triangle","danger","dqgeo:AddressNotFilled"))}initShowDetails(){this.showDetailsElement=i.UiComponents.button({icon:"list-ul",execute:()=>this.showDetails=!this.showDetails,className:"fc-action"})}initShowMapButton(){this.showMapButton=i.UiComponents.button({icon:()=>"map",execute:()=>{var e;(null===(e=this.Map)||void 0===e?void 0:e.options)&&(this.Map.options.visible=!this.Map.options.visible)},className:"fc-action"})}initDetails(){var e,t,n,o,r,a,s,c;const d=[{useIcon:!0,code:"home",additional:null!==(t=null===(e=this.houseDetails)||void 0===e?void 0:e.house)&&void 0!==t?t:l.empty()},{useIcon:!1,code:"Корпус",additional:null!==(o=null===(n=this.houseDetails)||void 0===n?void 0:n.corpsValue)&&void 0!==o?o:l.empty()},{useIcon:!1,code:null!==(a=null===(r=this.houseDetails)||void 0===r?void 0:r.str)&&void 0!==a?a:"Строение",additional:null!==(c=null===(s=this.houseDetails)||void 0===s?void 0:s.strValue)&&void 0!==c?c:l.empty()}];this.detailsElement=m(".address-details",d.map(e=>{return t=e.useIcon,n=e.code,o=e.additional,i.UiComponents.commonControl({readonly:!0,content:m(".address-details-house",[t?i.UiComponents.commonControl({readonly:!0,content:o,icon:n}):i.UiComponents.commonControl({readonly:!0,content:n}),t?null:i.UiComponents.commonControl({readonly:!0,content:o})])});var t,n,o}))}initMap(){this.geographyObjectRecord.Latitude&&this.geographyObjectRecord.Longitude&&(this.Map=new r.YandexMap(()=>({lat:this.geographyObjectRecord.Latitude,lon:this.geographyObjectRecord.Longitude}),{setMapToCenter:!0,balloonHeader:i.Utils.getText("dqgeo:Coordinates"),openBalloon:()=>!0,balloonContent:(e,t)=>o(this,void 0,void 0,function*(){return`${e}, ${t}`}),height:300}),this.Map.options.visible=this.options.mapAutoShow)}static empty(){return"("+i.Utils.getText("empty")+")"}}t.SimplifiedGeoCtrl=l},803:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,r){function a(e){try{c(o.next(e))}catch(e){r(e)}}function s(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.YandexMap=void 0;const i=n(931),r=n(725),a=n(678),s=n(305),{ui:c,viewer:l,utils:d}=s.legacy;t.YandexMap=class{constructor(e,t={}){this.source=e,this.options=t,this.mapZoom=13,this.coords={},this.DEFAULT_HEIGHT_PX=400,this.heightStorage=(0,a.getKeyStorage)("GeoCtrl:mapHeight",this.options.height||this.DEFAULT_HEIGHT_PX,this.options.height)}updateCoords(e){let t=this.source();this.map&&t.lat&&t.lon&&(e||!this.compareCoords(t))&&(this.coords=t,this.updateGeoObject().then(()=>!1!==r._.v(this.options.setMapToCenter)&&this.map.setCenter([this.coords.lat,this.coords.lon],this.mapZoom)))}updateGeoObject(){return o(this,void 0,void 0,function*(){let e=r._.v(this.options.iconDraggable),t=r._.v(this.options.iconLayout);this.map.geoObjects.removeAll();let n=new ymaps.GeoObject({geometry:{type:"Point",coordinates:[this.coords.lat,this.coords.lon]},properties:{hintContent:this.options.hintContent&&this.options.hintContent(this.coords.lat,this.coords.lon),balloonContentHeader:this.options.balloonHeader,balloonContentBody:this.options.balloonContent?yield this.options.balloonContent(this.coords.lat,this.coords.lon):`${this.coords.lat}, ${this.coords.lon} `}},{preset:t?void 0:this.options.iconPreset?r._.v(this.options.iconPreset):"islands#blueStretchyIcon",iconLayout:t?ymaps.templateLayoutFactory.createClass(t):void 0,draggable:e,iconShape:r._.v(this.options.iconShape)});e&&n.events.add("dragend",()=>{let e=n.geometry.getCoordinates();this.options.onIconDragEnd(e[0],e[1])}),this.options.onBalloonOpen&&n.events.add("balloonopen",()=>this.options.onBalloonOpen()),this.map.geoObjects.add(n),r._.v(this.options.openBalloon)&&n.balloon.open()})}createMap(e){let t=this.source();try{this.map=new ymaps.Map(e,{center:[t.lat,t.lon],zoom:this.mapZoom,controls:["zoomControl"]},{suppressMapOpenBlock:!0})}catch(e){console.error("Map error!",e)}this.updateCoords(!0)}compareCoords(e){return r._.deepEqual(e,this.coords)}getViewElement(){return this.options.visible?(this.updateCoords(),m(".yamap-wrapper",{style:{width:"100%",height:"300px"},config:(e,t,n)=>{if(t)return;const o=(0,i.withResize)(e,{direction:"vertical",onResized:e=>{var t;null===(t=this.map)||void 0===t||t.container.fitToViewport(),this.heightStorage.set(e.offsetHeight)}});d.loadScript("//api-maps.yandex.ru/2.1/?lang=ru_RU&coordorder=latlong").then(()=>{try{ymaps.ready(()=>{this.createMap(e)})}catch(e){console.error(e)}}),n.unload=()=>{this.map&&this.map.destroy(),this.coords=null,this.map=null,o()}},key:this.key})):""}}},931:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSizeValue=t.withResize=void 0,t.withResize=function(e,t){e.style.resize=t.direction;const n=new ResizeObserver(()=>t.onResized(e));return n.observe(e),()=>n.disconnect()},t.resolveSizeValue=function(e){return"number"==typeof e||parseFloat(e).toString().length===e.length?`${e}px`:e}},991:e=>{function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}e.exports=function(e){var n,o,i=(o=4,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var o,i,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(r.push(o.value),!t||r.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return r}}(n,o)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(n,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=i[1],a=i[3];if(!a)return r;if("function"==typeof btoa){var s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),l="/*# ".concat(c," */"),d=a.sources.map(function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")});return[r].concat(d).concat([l]).join("\n")}return[r].join("\n")}},998:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var o=n(72),i=n.n(o),r=n(229);i()(r.A,{insert:"head",singleton:!1});const a=r.A.locals||{}}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nc=void 0,(()=>{const e=n(305),t=n(769);n(998),e.FormService.registerControl({code:"dqgeo:yaMap",enabled:e=>!0,title:"dqgeo:yaMap",type:t.SimplifiedGeoCtrl}),(0,e.registerModule)(()=>{},{name:"dataquality-geo"})})()})();
//# sourceMappingURL=index.js.map