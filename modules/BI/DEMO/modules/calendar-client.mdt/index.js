(()=>{"use strict";var e={305:function(e,t,o){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.registerModule=t.legacy=t.modules=t.App=t.Schema=t.UiComponents=t.ModuleRegistry=t.RecordManager=t.CommandManager=t.Page=t.Auth=t.Filter=t.m=t.Api=t.Ui=t.Utils=t.mUtils=t.FieldControl=t.ControlManager=t.Form=t.FormService=t.List=t.ListService=t.SecurityManager=t.Navigation=t.MDT=void 0;var a=i(o(523));t.MDT=window.MDT,t.Navigation=t.MDT.Navigation,t.SecurityManager=t.MDT.SecurityManager,t.ListService=t.MDT.ListService,t.List=t.MDT.List,t.FormService=t.MDT.FormService,t.Form=t.MDT.Form,t.ControlManager=t.MDT.ControlManager,t.FieldControl=t.MDT.FieldControl,t.mUtils=t.MDT.mUtils,t.Utils=t.MDT.Utils,t.Ui=t.MDT.Ui,t.Api=t.MDT.Api,t.m=t.MDT.m,t.Filter=t.MDT.Filter,t.Auth=t.MDT.Auth,t.Page=t.MDT.Page,t.CommandManager=t.MDT.CommandManager,t.RecordManager=t.MDT.RecordManager,t.ModuleRegistry=t.MDT.ModuleRegistry,t.UiComponents=t.MDT.UiComponents,t.Schema=t.MDT.Schema,t.App=t.MDT.App,t.modules=t.MDT.modules,t.legacy=t.MDT.legacy,t.registerModule=function(e,o){t.MDT.registerModule(e,{version:a.default.version,name:null==o?void 0:o.name})}},437:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.prepareNavigation=void 0;const i=o(305);t.prepareNavigation=function(){i.SecurityManager.getUser().isAdmin&&i.Navigation.addNode({title:"calendar:Calendar",code:"calendar",icon:"calendar",parentPath:"adm/modules",controlCode:"dashboard",controlTemplate:{code:"calendar.SyncControlPanel"},childNodes:[{code:"years",title:null,objectCode:"calendar.Year"},{code:"halfyears",title:null,objectCode:"calendar.HalfYear"},{code:"quarters",title:null,objectCode:"calendar.Quarter"},{code:"months",title:null,objectCode:"calendar.Month"},{code:"weeks",title:null,objectCode:"calendar.Week"},{code:"dates",title:null,objectCode:"calendar.Date"},{code:"specialdatesbycountry",title:null,objectCode:"calendar.SpecialDateByCountry"},{code:"specialdatetypes",title:null,objectCode:"calendar.SpecialDateType"},{code:"periods",title:null,objectCode:"calendar.Period"},{code:"periodtypes",title:null,objectCode:"calendar.PeriodType"}]})}},489:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.customizeForm=void 0;const i=o(305);t.customizeForm=function(){i.FormService.onCreated(e=>{"calendar.SyncControlPanel"==e.getObject().getCode()&&(e.addCommand({title:"Включить синхронизацию",type:"primary",execute:()=>{i.Api.fetchRecord("job.Task",{top:1,filter:{op:"eq",p1:"Code",p2:"calendar.sync"}}).then(e=>{e&&(1!=e.FlagActive?(i.Api.fetchRecord("job.History",{top:1,filter:{op:"eq",p1:"ID_Task",p2:e.ID}}).then,i.Api.save("job.Task",{ID:e.ID,FlagActive:!0}),i.Ui.showNotification({title:"Синхронизация включена",text:`Включена служба ${e.Code}`},5e3)):i.Ui.showNotification({title:"Синхронизация уже включена",text:null},5e3))})}}),e.addCommand({title:"Приостановить синхронизацию",type:"fatal",execute:()=>{i.Api.fetchRecord("job.Task",{top:1,filter:{op:"eq",p1:"Code",p2:"calendar.sync"}}).then(e=>{e&&(0!=e.FlagActive?(i.Api.save("job.Task",{ID:e.ID,FlagActive:!1}),i.Ui.showNotification({title:"Синхронизация приостановлена",text:`Выключена служба ${e.Code}`},5e3)):i.Ui.showNotification({title:"Синхронизация уже приостановлена",text:null},5e3))})}}),e.addCommand({title:"Выполнить синхронизацию немедленно",type:"primary",execute:()=>{i.Ui.showNotification({title:"Процесс синхронизация запущен",text:"Происходит выполнение службы calendar.sync"},5e3),i.Api.request("job/ExecTask?taskcode=calendar.sync",{},{method:"POST"}).then(()=>{i.Ui.showNotification({title:"Процесс синхронизация завершен",text:"Завершено выполнение службы calendar.sync"},5e3)})}}))})}},523:e=>{e.exports=JSON.parse('{"name":"mdt-client","version":"31.0.13","description":"","main":"dist/index.js","types":"dist/index.d.ts","files":["/dist","/types"],"scripts":{"build":"tsc","types-update":"tsc --project tsconfig.facade-types.json","update":"tsc --project tsconfig.facade-types.json && tsc","pub-patch":"npm version patch && npm publish","pub-minor":"npm version minor && npm publish"},"repository":{"type":"git","url":"git@gitlab.ics-it.ru:mdtc/mdt-facade.git"},"author":"","license":"ISC","devDependencies":{"typescript":"^4.8.4"},"dependencies":{"@types/mithril":"^0.0.27"}}')}},t={};function o(i){var a=t[i];if(void 0!==a)return a.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,o),r.exports}(()=>{const e=o(437),t=o(305),i=o(489);t.registerModule(()=>{e.prepareNavigation(),i.customizeForm()},{name:"calendar-client"})})()})();
//# sourceMappingURL=index.js.map